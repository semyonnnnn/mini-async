(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{blackLower:()=>C,blueUpper:()=>b,circleDigit:()=>p,circleWrapper:()=>c,currentMonth:()=>a,dateCalendrier:()=>f,dateWrapper:()=>u,displayedYear:()=>d,grandWrapper:()=>y,hiddenYear:()=>o,horizontalLine:()=>h,innerWrapper:()=>S,list:()=>x,month:()=>i,monthsInnerWrapper:()=>r,monthsOuterWrapper:()=>n,outerWrapper:()=>w,smallListContainer:()=>v,statCalendrier:()=>g,verticalLine:()=>m,yearWrapper:()=>l});const n={display:"flex",gap:"1rem",marginLeft:"15vw",position:"relative"},a={background:"linear-gradient(to right, #75ebbc, rgba(117, 235, 188, .3))",height:"fit-content",padding:"0rem 5rem",width:"fit-content",color:"#22608a",userSelect:"none",cursor:"pointer",fontSize:"5rem",fontFamily:"DelaGothicOne",fontWeight:900,fontStyle:"black",transform:"rotate(-5deg)",lineHeight:1.4,overflow:"visible"},r={userSelect:"none",display:"flex",flexDirection:"column",color:"#22608a",background:"linear-gradient(to right, #75ebbc, #3997af)",padding:".5rem 0",fontSize:"2rem",fontFamily:"DelaGothicOne",fontWeight:600,fontStyle:"black",display:"none",position:"absolute",left:"6rem",zIndex:"99",position:"absolute",top:"10rem",left:"0rem"},i={padding:"0",paddingLeft:"5rem",paddingRight:"15rem",cursor:"pointer",hover:{backgroundColor:"white"}},s={padding:"2rem 5rem",color:"#82ffc3",width:"fit-content",userSelect:"none",cursor:"pointer",fontSize:"5rem",fontWeight:"900",transform:"rotate(5deg) translateY(-2rem)",position:"absolute",backgroundColor:"#3a98b0",fontFamily:"DelaGothicOne"},l={height:"10rem",display:"flex",gap:"1rem",marginBottom:"1rem",fontFamily:"OpenSans",width:"fit-content"},o={...s,zIndex:"2"},d={...s,zIndex:"3"},c={backgroundColor:"white",fontSize:"4rem",width:"7rem",height:"7rem",borderRadius:"1000px",position:"relative",boxShadow:"0px 7px 10px rgba(0,0,0,.3)",zIndex:"3"},p={userSelect:"none",fontFamily:"",position:"absolute",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",color:"#0f81a3",fontStyle:"normal",fontWeight:600,zIndex:"3"},h={position:"absolute",backgroundColor:"white",width:"100%",height:".7rem",zIndex:"2",top:"6rem",boxShadow:"0px 5px 5px rgb(50,50,50)"},m={position:"absolute",backgroundColor:"white",width:".7rem",height:"3rem",zIndex:"2",top:"6rem",boxShadow:"0 3px 5px rgb(50,50,50)"},u={display:"flex",gap:"3vw",flexWrap:"wrap"},f={display:"flex",flexDirection:"column",gap:"3rem",marginTop:"3rem",fontFamily:"OpenSans"},g={color:"white",fontSize:"3rem",textAlign:"center",userSelect:"none"},y={padding:"2rem",backgroundColor:"rgba(255, 245, 255, .1)",borderRadius:"2rem"},w={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(15rem, 2fr))",gap:"2rem",padding:"2rem 7rem",overflow:"hidden"},S={display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",gap:"1rem",minWidth:"10rem",width:"100%",padding:"1rem .5rem",borderRadius:"10px",fontSize:".8rem",fontFamily:"OpenSans",fontWeight:400,fontStyle:"normal",position:"relative"},b={color:"#0f81a3",textWrap:"wrap",textAlign:"center",fontSize:"1.5rem",fontWeight:400,fontStyle:"normal"},C={fontWeight:400,fontSize:"1.2rem",color:"rgb(51, 51, 51)"},x={width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"1rem",backgroundColor:"white",padding:"1rem 0",boxShadow:"3px 7px 7px rgba(0,0,0,.5)",zIndex:"3"},v={padding:".4rem 0",width:"100%",borderRadius:"10px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},O=document.createElement("style");O.textContent=[{name:"OpenSans",file:"Open_Sans/OpenSans-Regular.ttf",weight:400,style:"normal"},{name:"OpenSans",file:"Open_Sans/OpenSans-Bold.ttf",weight:700,style:"normal"},{name:"OpenSans",file:"Open_Sans/OpenSans-Black.ttf",weight:900,style:"normal"},{name:"OpenSans",file:"Open_Sans/OpenSans-Italic.ttf",weight:400,style:"italic"},{name:"OpenSans",file:"Open_Sans/OpenSans-BoldItalic.ttf",weight:700,style:"italic"},{name:"OpenSans",file:"Open_Sans/OpenSans-ExtraBold.ttf",weight:800,style:"normal"},{name:"OpenSans",file:"Open_Sans/OpenSans-SemiBold.ttf",weight:600,style:"normal"},{name:"OpenSans",file:"Open_Sans/OpenSans-ExtraBoldItalic.ttf",weight:800,style:"italic"},{name:"OpenSans",file:"Open_Sans/OpenSans-Thin.ttf",weight:100,style:"normal"},{name:"OpenSans",file:"Open_Sans/OpenSans-ThinItalic.ttf",weight:100,style:"italic"},{name:"DelaGothicOne",file:"Dela_Gothic_One/DelaGothicOne-Regular.ttf",weight:900,style:"normal"}].map((({name:e,file:t,weight:n,style:a})=>`\n    @font-face {\n      font-family: '${e}';\n      src: url('/fonts/${t}');\n      font-weight: ${n};\n      font-style: ${a};\n    }\n  `)).join("\n"),document.head.appendChild(O);const E=["отчетная дата","краткое наименование","отчетный период"];class L{constructor(e){this.year=e}async init(){this.rawJSON=await this.getRawJSON(),this.sorted=await this.JSON_sorted()}async getRawJSON(){const e=`https://raw.githubusercontent.com/Kanoe99/files/main/stat_calendar_${this.year}.xlsx`,t=await fetch(e),n=await t.arrayBuffer(),a=XLSX.read(n,{type:"array"}),r=a.SheetNames[0],i=a.Sheets[r],s=XLSX.utils.sheet_to_json(i,{header:1,defval:""}).map((e=>e.map((e=>void 0!==e||null!==e?e.toString():"")))),l=s[0],[o,d,c]=E.map((e=>l.findIndex((t=>function(e){return e.toLowerCase().replace(/ё/g,"е")}(t).includes(e))))),p=[d,c,o],h=s.filter(((e,t,n)=>!e[s[0].findIndex((e=>e.trim().toLowerCase().includes("примечание")))].trim().toLowerCase().includes("отмен"))).map(((e,t)=>e.map(((e,n)=>({name:`${XLSX.utils.encode_col(n)}.${t+1}`,value:e}))).filter(((e,t)=>p.includes(t))).map(((e,t)=>{if(2===t&&/^\d+$/.test(e.value)){const t=parseInt(e.value,10),n=new Date(Date.UTC(1899,11,30)),a=864e5,r=new Date(n.getTime()+t*a),i=new Intl.DateTimeFormat("ru-RU").format(r);return{name:e.name,value:i}}return e})))),m=(e,t)=>{if(e.value.trim()){if(2===t){if(/^\d{2}\.\d{2}\.\d{4}$/.test(e.value)){const[t,n,a]=e.value.split(".").map(Number),r=new Date(a,n-1,t);return r.getFullYear()===a&&r.getMonth()===n-1&&r.getDate()===t}return!1}return!0}return!1},u=h.filter((e=>e.every(m))),f=h.filter((e=>!e.every(m))),g=[];return 0===Object.keys(f).length?g["Вы молодец"]=["Ошибок в Excel файле нет!"]:f.slice(1).forEach((e=>e.forEach(((e,t)=>{const n=e.value,a=e.name;if(n.trim()){if(2===t)if(/^\d{2}\.\d{2}\.\d{4}$/.test(n)){const[t,r,i]=e.value.split(".").map(Number),s=new Date(i,r-1,t);s.getFullYear()===i&&s.getMonth()===r-1&&s.getDate()===t||(g[`Образец даты ${a}: <dd.mm.yyyy>`]=`${a}: [${n}]`)}else g[`Образец даты ${a}: <dd.mm.yyyy>`]=`${a}: [${n}]`}else g[`Пустая ячейка ${a}`]=`${a}: [${n}]`})))),console.table(g),u.map((e=>e.map((e=>e.value))))}async JSON_sorted(){const e=this.rawJSON,t=Number(e[0][2].split(".")[2]),n=[new Array(31),new Array(t%4==0?29:28),new Array(31),new Array(30),new Array(31),new Array(30),new Array(31),new Array(31),new Array(30),new Array(31),new Array(30),new Array(31)];return e.forEach((e=>{const t=Number(e[2].split(".")[0])-1,a=Number(e[2].split(".")[1])-1;n[a][t]?n[a][t].push([e[0],e[1]]):n[a][t]=[[e[0],e[1]]]})),n}}class Y{constructor(e){this.cms_block=e,this.grandWrapper=document.createElement("div"),this.dateCalendrier=document.createElement("div"),this.requestedYear=new URLSearchParams(window.location.search).get("y"),this.requestedMonth=(()=>{const e=new URLSearchParams(window.location.search).get("m");return null===e||isNaN(e)?null:Number(e)-1})(),this.nowYear=(new Date).getFullYear(),this.nowMonth=(new Date).getMonth();const t={currentMonth:this.requestedMonth??this.nowMonth,displayedYear:this.requestedYear??this.nowYear,hiddenYear:null!==this.requestedYear&&this.requestedYear!==this.nowYear?this.requestedYear+1:this.nowYear-1};this.currentMonthEl=null,this.displayedYearEl=null,this.state=new Proxy(t,{set:async(e,t,n,a)=>{const r=Reflect.set(e,t,n,a);return"currentMonth"===t&&(this.parser?.sorted&&(this.data=this.parser.sorted[n]),this.currentMonthEl&&(this.currentMonthEl.textContent=this.getMonthNames(n)),this.build()),"displayedYear"===t&&(this.parser=new L(n),await this.parser.init(),this.data=this.parser.sorted[this.state.currentMonth],this.displayedYearEl&&(this.displayedYearEl.textContent=n),this.build()),r}})}async init(){return this.parser=new L(this.state.displayedYear),await this.parser.init(),this.data=this.parser.sorted[this.state.currentMonth],this.build(),this}build=async()=>{this.cms_block.innerHTML="",this.grandWrapper.innerHTML="",this.dateCalendrier.innerHTML="",this.create_DOM(this.cms_block),this.assignStyles()};create_DOM(e){const t=document.createElement("div");t.classList="outerWrapper",Array.isArray(this.data)?(this.createPicker(e),this.data.forEach(((e,n)=>{const a=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),o=document.createElement("div");this.grandWrapper.classList="grandWrapper",r.classList="circleDigit",r.textContent=n+1,s.classList="circleWrapper",l.classList="horizontalLine",a.appendChild(l),o.classList="verticalLine",a.appendChild(o),i.classList="list",a.classList="innerWrapper",e.forEach((e=>{const t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div");t.textContent=e[0],n.textContent=e[1],t.classList="blueUpper",n.classList="blackLower",a.classList="smallListContainer",a.appendChild(t),a.appendChild(n),i.appendChild(a)})),s.appendChild(r),a.appendChild(s),a.appendChild(i),t.appendChild(a)})),this.grandWrapper.appendChild(t),e.appendChild(this.grandWrapper)):console.error(`this.data: ${this.data}`)}getMonthNames(e){const t=new Date(this.state.displayedYear,e),n=new Intl.DateTimeFormat("ru-RU",{month:"long"}).format(t);return n[0].toUpperCase()+n.slice(1)}createPicker(e){const t=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),l=document.createElement("div"),o=document.createElement("div"),d=document.createElement("div");a.classList="dateWrapper",n.innerText="СТАТКАЛЕНДАРЬ".toUpperCase(),this.dateCalendrier.appendChild(a),this.dateCalendrier.appendChild(n),t.appendChild(this.dateCalendrier),t.appendChild(a),n.classList="statCalendrier",this.dateCalendrier.classList="dateCalendrier",r.classList="yearWrapper",l.classList="monthsOuterWrapper",s.classList="hiddenYear",this.hiddenYear=s,s.textContent=this.state.hiddenYear,i.classList="displayedYear",this.displayedYearEl=i,i.textContent=this.state.displayedYear,r.appendChild(i),r.appendChild(s),i.addEventListener("click",(async()=>{const e=this.state.hiddenYear,t=this.state.displayedYear;this.state.displayedYear=e,this.state.hiddenYear=t,this.hiddenYear.textContent=t})),o.classList="currentMonth",this.currentMonthEl=o,d.classList="monthsInnerWrapper";for(let e=0;e<12;e++){const t=document.createElement("div");t.textContent=this.getMonthNames(e),t.className="month",d.appendChild(t),t.addEventListener("click",(()=>{d.style.display="none",this.state.currentMonth=e}))}o.textContent=this.getMonthNames(this.state.currentMonth),o.addEventListener("click",(()=>{const e=d.style;e.display="none"===e.display?"block":"none"})),l.appendChild(o),l.appendChild(d),a.appendChild(l),a.appendChild(r),this.dateCalendrier.appendChild(a),this.grandWrapper.appendChild(this.dateCalendrier)}assignStyles=()=>{for(const e in t){const n=t[e],a=n.hover,{hover:r,...i}=n;document.querySelectorAll(`.${e}`).forEach((e=>{Object.assign(e.style,i),a&&(e.addEventListener("mouseenter",(()=>{Object.assign(e.style,a)})),e.addEventListener("mouseleave",(()=>{for(const t in a)e.style[t]="";Object.assign(e.style,i)})))}))}}}document.addEventListener("DOMContentLoaded",(async()=>{const e=document.getElementById("c447f2f0-11ee-4833-9f95-cd7c08ba671e")?.parentElement;if(e){Object.assign(e.style,{padding:"2rem",margin:0,backgroundColor:"#238ca6"});const t=new Y(e);await t.init()}}))})();