(()=>{"use strict";var e,t,r={},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var i=n[e]={exports:{}};return r[e](i,i.exports,a),i.exports}a.m=r,a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[])),a.u=e=>e+".prod.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="nav:",a.l=(r,n,i,s)=>{if(e[r])e[r].push(n);else{var o,l;if(void 0!==i)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var h=d[c];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+i){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",t+i),o.src=r),e[r]=[n];var p=(t,n)=>{o.onerror=o.onload=null,clearTimeout(m);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},m=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),l&&document.head.appendChild(o)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={792:0};a.f.j=(t,r)=>{var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var i=new Promise(((r,a)=>n=e[t]=[r,a]));r.push(n[2]=i);var s=a.p+a.u(t),o=new Error;a.l(s,(r=>{if(a.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var i=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+s+")",o.name="ChunkLoadError",o.type=i,o.request=s,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,i,[s,o,l]=r,d=0;if(s.some((t=>0!==e[t]))){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);l&&l(a)}for(t&&t(r);d<s.length;d++)i=s[d],a.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunknav=self.webpackChunknav||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var i={};a.r(i),a.d(i,{blackLower:()=>W,blueUpper:()=>L,circleDigit:()=>f,circleWrapper:()=>g,currentMonth:()=>l,dateCalendrier:()=>b,dateWrapper:()=>v,displayedYear:()=>u,grandWrapper:()=>x,hiddenYear:()=>m,horizontalLine:()=>y,info:()=>Y,innerWrapper:()=>S,link:()=>M,list:()=>k,month:()=>c,monthsInnerWrapper:()=>d,monthsOuterWrapper:()=>o,outerWrapper:()=>E,qr:()=>D,smallListContainer:()=>O,statCalendrier:()=>C,verticalLine:()=>w,yearWrapper:()=>p});var s={};a.r(s),a.d(s,{main_config:()=>_});const o={display:"flex",gap:"2rem",marginLeft:"0",position:"relative"},l={textWrap:"nowrap",background:"linear-gradient(to right, #75ebbc,#51b8b4)",height:"fit-content",padding:"0rem 2vw",width:"fit-content",color:"#22608a",userSelect:"none",cursor:"pointer",fontSize:"3rem",fontFamily:"Dela Gothic One",fontWeight:900,fontStyle:"black",transform:"rotate(-5deg)",lineHeight:1.4,overflow:"visible",marginBottom:"5rem"},d={textWrap:"nowrap",userSelect:"none",display:"flex",flexDirection:"column",color:"#22608a",background:"linear-gradient(to right, #75ebbc, #3997af)",padding:".5rem 0",fontSize:"2rem",fontFamily:"Dela Gothic One",fontWeight:600,fontStyle:"black",display:"none",position:"absolute",left:"6rem",zIndex:"99",position:"absolute",top:"10rem",left:"0rem"},c={textWrap:"nowrap",padding:"0",paddingLeft:"5rem",paddingRight:"15rem",cursor:"pointer",hover:{backgroundColor:"white"}},h={textWrap:"nowrap",padding:"1vw 2vw",color:"#82ffc3",width:"fit-content",userSelect:"none",cursor:"pointer",fontSize:"3rem",fontWeight:"900",transform:"rotate(5deg) translateY(-2rem)",position:"absolute",backgroundColor:"#3a98b0",fontFamily:"Dela Gothic One"},p={height:"5rem",display:"flex",gap:"1rem",marginBottom:"1rem",fontFamily:"Open Sans",width:"15rem",justifyContent:"center",alignItems:"center"},m={...h,zIndex:"2"},u={...h,zIndex:"3"},g={backgroundColor:"white",fontSize:"4rem",width:"7rem",height:"7rem",borderRadius:"1000px",position:"relative",boxShadow:"0px 7px 10px rgba(0,0,0,.3)",zIndex:"3"},f={userSelect:"none",fontFamily:"",position:"absolute",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",color:"#0f81a3",fontStyle:"normal",fontWeight:600,zIndex:"3"},y={position:"absolute",backgroundColor:"white",width:"100%",height:".7rem",zIndex:"2",top:"6rem",boxShadow:"0px 5px 5px rgb(50,50,50)"},w={position:"absolute",backgroundColor:"white",width:".7rem",height:"3rem",zIndex:"2",top:"6rem",boxShadow:"0 3px 5px rgb(50,50,50)"},v={display:"flex",gap:"3vw",flexWrap:"wrap",justifyContent:"center",alignItems:"center"},b={display:"flex",flexDirection:"column",gap:"3rem",marginTop:"3rem",fontFamily:"Open Sans"},C={color:"white",fontSize:"5vw",textAlign:"center",userSelect:"none",marginTop:"2rem"},x={padding:"0rem",backgroundImage:"url('https://66.rosstat.gov.ru/storage/mediabank/tile.png')",backgroundRepeat:"repeat",borderRadius:"2rem"},E={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(12rem, 2fr))",gap:"2rem",padding:"2rem 1rem",overflow:"hidden"},S={display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",gap:"1rem",minWidth:"10rem",width:"100%",padding:"1rem .5rem",borderRadius:"10px",fontSize:".8rem",fontFamily:"Open Sans",fontWeight:400,fontStyle:"normal",position:"relative"},L={color:"#0f81a3",textWrap:"wrap",textAlign:"center",fontSize:"1.5rem",fontWeight:400,fontStyle:"normal"},W={fontWeight:400,fontSize:"1.2rem",color:"rgb(51, 51, 51)"},k={width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"1rem",backgroundColor:"white",padding:"1rem 0",boxShadow:"3px 7px 7px rgba(0,0,0,.5)",zIndex:"3"},O={padding:".4rem 0",width:"100%",borderRadius:"10px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},Y={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"2rem 5rem"},M={color:"white",backgroundColor:"#22608a",fontFamily:"Open Sans",width:"17rem",padding:"2rem",fontWeight:600,display:"grid",placeItems:"center"},D={width:"10rem",height:"10rem"};function I(e){if(!Array.from(document.head.querySelectorAll("link")).some((t=>Object.entries(e).every((([e,r])=>t[e]===r))))){const t=document.createElement("link");Object.assign(t,e),document.head.appendChild(t)}}I({rel:"preconnect",href:"https://fonts.googleapis.com"}),I({rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:""}),I({rel:"stylesheet",href:"https://fonts.googleapis.com/css2?family=Dela+Gothic+One&family=Montserrat+Alternates:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap"});const A=["отчетная дата","краткое наименование","отчетный период"],j="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname||"undefined"!=typeof process&&!1,N=(new Date).getFullYear(),$=j?`https://raw.githubusercontent.com/Kanoe99/files/main/stat_calendar_${N}.xlsx`:`https://66.rosstat.gov.ru/storage/mediabank/stat_calendar_${N}.xlsx`;class T{async init(){this.XLSX=await(async()=>{if(j){const{read:e,utils:t}=window.XLSX;return{read:e,utils:t}}{const e=await a.e(138).then(a.bind(a,138)),{read:t,utils:r}=e.default||e;return{read:t,utils:r}}})(),this.rawJSON=await this.getRawJSON(),this.sorted=await this.JSON_sorted()}async getRawJSON(){const e=await fetch($),t=await e.arrayBuffer(),r=this.XLSX.read(t,{type:"array"}),n=r.SheetNames[0],a=r.Sheets[n],i=this.XLSX.utils.sheet_to_json(a,{header:1,defval:""}).map((e=>e.map((e=>void 0!==e||null!==e?e.toString():"")))),s=i[0],[o,l,d]=A.map((e=>s.findIndex((t=>function(e){return e.toLowerCase().replace(/ё/g,"е")}(t).includes(e))))),c=[l,d,o],h=i.filter(((e,t,r)=>!e[i[0].findIndex((e=>e.trim().toLowerCase().includes("примечание")))].trim().toLowerCase().includes("отмен"))).map(((e,t)=>e.map(((e,r)=>({name:`${this.XLSX.utils.encode_col(r)}.${t+1}`,value:e}))).filter(((e,t)=>c.includes(t))).map(((e,t)=>{if(2===t&&/^\d+$/.test(e.value)){const t=parseInt(e.value,10),r=new Date(Date.UTC(1899,11,30)),n=864e5,a=new Date(r.getTime()+t*n),i=new Intl.DateTimeFormat("ru-RU").format(a);return{name:e.name,value:i}}return e})))),p=(e,t)=>{if(e.value.trim()){if(2===t){if(/^\d{2}\.\d{2}\.\d{4}$/.test(e.value)){const[t,r,n]=e.value.split(".").map(Number),a=new Date(n,r-1,t);return a.getFullYear()===n&&a.getMonth()===r-1&&a.getDate()===t}return!1}return!0}return!1},m=h.filter((e=>e.every(p))),u=h.filter((e=>!e.every(p))),g=[];return 0===Object.keys(u).length?g["Вы молодец"]=["Ошибок в Excel файле нет!"]:u.slice(1).forEach((e=>e.forEach(((e,t)=>{const r=e.value,n=e.name;if(r.trim()){if(2===t)if(/^\d{2}\.\d{2}\.\d{4}$/.test(r)){const[t,a,i]=e.value.split(".").map(Number),s=new Date(i,a-1,t);s.getFullYear()===i&&s.getMonth()===a-1&&s.getDate()===t||(g[`Образец даты ${n}: <dd.mm.yyyy>`]=`${n}: [${r}]`)}else g[`Образец даты ${n}: <dd.mm.yyyy>`]=`${n}: [${r}]`}else g[`Пустая ячейка ${n}`]=`${n}: [${r}]`})))),console.table(g),m.map((e=>e.map((e=>e.value))))}async JSON_sorted(){const e=this.rawJSON,t=Number(e[0][2].split(".")[2]),r=[new Array(31),new Array(t%4==0?29:28),new Array(31),new Array(30),new Array(31),new Array(30),new Array(31),new Array(31),new Array(30),new Array(31),new Array(30),new Array(31)];return e.forEach((e=>{const t=Number(e[2].split(".")[0])-1,n=Number(e[2].split(".")[1])-1;r[n][t]?r[n][t].push([e[0],e[1]]):r[n][t]=[[e[0],e[1]]]})),r}}class z{constructor(e){this.cms_block=e,this.grandWrapper=document.createElement("div"),this.dateCalendrier=document.createElement("div"),this.requestedYear=new URLSearchParams(window.location.search).get("y"),this.requestedMonth=(()=>{const e=new URLSearchParams(window.location.search).get("m");return null===e||isNaN(e)?null:Number(e)-1})(),this.nowYear=(new Date).getFullYear(),this.nowMonth=(new Date).getMonth();const t={currentMonth:this.requestedMonth??this.nowMonth,displayedYear:this.requestedYear??this.nowYear,hiddenYear:null!==this.requestedYear&&this.requestedYear!==this.nowYear?this.requestedYear+1:this.nowYear-1};this.currentMonthEl=null,this.displayedYearEl=null,this.state=new Proxy(t,{set:async(e,t,r,n)=>{const a=Reflect.set(e,t,r,n);return"currentMonth"===t&&(this.parser?.sorted&&(this.data=this.parser.sorted[r]),this.currentMonthEl&&(this.currentMonthEl.textContent=this.getMonthNames(r)),this.build()),"displayedYear"===t&&(this.parser=new T(r),await this.parser.init(),this.data=this.parser.sorted[this.state.currentMonth],this.displayedYearEl&&(this.displayedYearEl.textContent=r),this.build()),a}})}async init(){return this.parser=new T(this.state.displayedYear),await this.parser.init(),this.data=this.parser.sorted[this.state.currentMonth],this.build(),this}build=async()=>{this.cms_block.innerHTML="",this.grandWrapper.innerHTML="",this.dateCalendrier.innerHTML="",this.create_DOM(this.cms_block),this.assignStyles()};create_DOM(e){const t=document.createElement("div");if(t.classList="outerWrapper",!Array.isArray(this.data))return void console.error(`this.data: ${this.data}`);this.createPicker(e),this.data.forEach(((e,r)=>{const n=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),l=document.createElement("div");this.grandWrapper.classList="grandWrapper",a.classList="circleDigit",a.textContent=r+1,s.classList="circleWrapper",o.classList="horizontalLine",n.appendChild(o),l.classList="verticalLine",n.appendChild(l),i.classList="list",n.classList="innerWrapper",e.forEach((e=>{const t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div");t.textContent=e[0],r.textContent=e[1],t.classList="blueUpper",r.classList="blackLower",n.classList="smallListContainer",n.appendChild(t),n.appendChild(r),i.appendChild(n)})),s.appendChild(a),n.appendChild(s),n.appendChild(i),t.appendChild(n)})),this.grandWrapper.appendChild(t);const r=document.createElement("div");r.classList="info";const n=document.createElement("img");n.src="https://66.rosstat.gov.ru/storage/mediabank/qr-code.svg",n.classList="qr";const a=document.createElement("div");a.classList="link",a.textContent="получить индивидуальный перечень форм".toUpperCase(),r.appendChild(a),r.appendChild(n),this.grandWrapper.appendChild(r),e.appendChild(this.grandWrapper)}getMonthNames(e){const t=new Date(this.state.displayedYear,e),r=new Intl.DateTimeFormat("ru-RU",{month:"long"}).format(t);return r[0].toUpperCase()+r.slice(1)}createPicker(e){const t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div");n.classList="dateWrapper",r.innerText="СТАТКАЛЕНДАРЬ".toUpperCase(),this.dateCalendrier.appendChild(n),this.dateCalendrier.appendChild(r),t.appendChild(this.dateCalendrier),t.appendChild(n),r.classList="statCalendrier",this.dateCalendrier.classList="dateCalendrier",a.classList="yearWrapper",o.classList="monthsOuterWrapper",s.classList="hiddenYear",this.hiddenYear=s,s.textContent=this.state.hiddenYear,i.classList="displayedYear",this.displayedYearEl=i,i.textContent=this.state.displayedYear,a.appendChild(i),a.appendChild(s),i.addEventListener("click",(async()=>{const e=this.state.hiddenYear,t=this.state.displayedYear;this.state.displayedYear=e,this.state.hiddenYear=t,this.hiddenYear.textContent=t})),l.classList="currentMonth",this.currentMonthEl=l,d.classList="monthsInnerWrapper";for(let e=0;e<12;e++){const t=document.createElement("div");t.textContent=this.getMonthNames(e),t.className="month",d.appendChild(t),t.addEventListener("click",(()=>{d.style.display="none",this.state.currentMonth=e}))}l.textContent=this.getMonthNames(this.state.currentMonth),l.addEventListener("click",(()=>{const e=d.style;e.display="none"===e.display?"block":"none"})),o.appendChild(l),o.appendChild(d),n.appendChild(o),n.appendChild(a),this.dateCalendrier.appendChild(n),this.grandWrapper.appendChild(this.dateCalendrier)}assignStyles=()=>{for(const e in i){const t=i[e],r=t.hover,{hover:n,...a}=t;document.querySelectorAll(`.${e}`).forEach((e=>{Object.assign(e.style,a),r&&(e.addEventListener("mouseenter",(()=>{Object.assign(e.style,r)})),e.addEventListener("mouseleave",(()=>{for(const t in r)e.style[t]="";Object.assign(e.style,a)})))}))}}}const _={grandWrapper:{html:"div",class:"grandWrapper",children:{dateCalendrier:{html:"div",class:"dateCalendrier",children:{statCalendrier:{html:"div",class:"statCalendrier"},dateWrapper:{html:"div",class:"dateWrapper",children:{monthsOuterWrapper:{html:"div",class:"monthsOuterWrapper",children:{currentMonth:{html:"div",class:"currentMonth"},monthsInnerWrapper:{html:"div",class:"monthsInnerWrapper",children:{month1:{html:"div",class:"month"},month2:{html:"div",class:"month"},month3:{html:"div",class:"month"},month4:{html:"div",class:"month"},month5:{html:"div",class:"month"},month6:{html:"div",class:"month"},month7:{html:"div",class:"month"},month8:{html:"div",class:"month"},month9:{html:"div",class:"month"},month10:{html:"div",class:"month"},month11:{html:"div",class:"month"},month12:{html:"div",class:"month"}}}}},yearWrapper:{html:"div",class:"yearWrapper",children:{displayedYear:{html:"div",class:"displayedYear"},hiddenYear:{html:"div",class:"hiddenYear"}}}}}}},outerWrapper:{},info:{}}}};document.addEventListener("DOMContentLoaded",(async()=>{const e=document.getElementById("c447f2f0-11ee-4833-9f95-cd7c08ba671e").parentElement,t=document.head,r=document.createElement("link");r.rel="preconnect",r.href="https://fonts.googleapis.com",t.appendChild(r);const n=document.createElement("link");n.rel="preconnect",n.href="https://fonts.gstatic.com",n.crossOrigin="",t.appendChild(n);const a=document.createElement("link");if(a.rel="stylesheet",a.href="https://fonts.googleapis.com/css2?family=Dela+Gothic+One&family=Montserrat+Alternates:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap",t.appendChild(a),e){Object.assign(e.style,{padding:"2rem",margin:0,backgroundColor:"#238ca6"});const t=new z(e);await t.init()}})),console.log("this is obj:",s)})();