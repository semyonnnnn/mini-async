(()=>{"use strict";var e,t,r={},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={exports:{}};return r[e](s,s.exports,a),s.exports}a.m=r,a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((t,r)=>(a.f[r](e,t),t)),[])),a.u=e=>e+".prod.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="nav:",a.l=(r,n,s,i)=>{if(e[r])e[r].push(n);else{var o,l;if(void 0!==s)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var h=d[c];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[n];var p=(t,n)=>{o.onerror=o.onload=null,clearTimeout(u);var a=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),a&&a.forEach((e=>e(n))),t)return t(n)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=p.bind(null,o.onerror),o.onload=p.bind(null,o.onload),l&&document.head.appendChild(o)}},a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e})(),(()=>{var e={792:0};a.f.j=(t,r)=>{var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var s=new Promise(((r,a)=>n=e[t]=[r,a]));r.push(n[2]=s);var i=a.p+a.u(t),o=new Error;a.l(i,(r=>{if(a.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var s=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,n[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,s,[i,o,l]=r,d=0;if(i.some((t=>0!==e[t]))){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);l&&l(a)}for(t&&t(r);d<i.length;d++)s=i[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunknav=self.webpackChunknav||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var s={};a.r(s),a.d(s,{blackLower:()=>b,blueUpper:()=>w,circleDigit:()=>g,circleWrapper:()=>y,currentMonth:()=>o,displayedYear:()=>u,hiddenYear:()=>p,innerWrapper:()=>f,list:()=>v,month:()=>d,monthsInnerWrapper:()=>l,monthsOuterWrapper:()=>i,outerWrapper:()=>m,smallListContainer:()=>x,yearWrapper:()=>h});const i={display:"flex",gap:"1rem"},o={backgroundColor:"rgb(174, 145, 255)",height:"3rem",padding:"0 1rem",width:"fit-content",display:"flex",justifyContent:"center",alignItems:"center",borderRadius:"10px",color:"white",boxShadow:"inset 0px -4px 4px rgba(100, 44, 255, 0.2)",userSelect:"none",cursor:"pointer",fontSize:".8rem",fontFamily:"MontserratAlternates",fontWeight:600,fontStyle:"black"},l={userSelect:"none",display:"flex",flexDirection:"column",color:"white",backgroundColor:"rgb(79, 56, 145)",padding:".5rem 0",borderRadius:"10px",fontSize:".8rem",fontFamily:"MontserratAlternates",fontWeight:600,fontStyle:"black",display:"none",position:"absolute",left:"6rem",zIndex:"99"},d={padding:".5rem 2rem",cursor:"pointer",hover:{backgroundColor:"red"}},c={padding:"2rem 5rem",backgroundColor:"black",color:"white",width:"fit-content",userSelect:"none",cursor:"pointer"},h={display:"flex",gap:"1rem",marginBottom:"1rem"},p={...c},u={...c},m={display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(15rem, 2fr))",gap:"2rem",padding:"2rem",backgroundColor:"rgb(244, 245, 255)"},f={display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"center",gap:"1rem",minWidth:"10rem",width:"100%",boxShadow:"0px 0px 7px black",padding:"1rem .5rem",borderRadius:"10px",fontSize:".8rem",fontFamily:"MontserratAlternates",fontWeight:400,fontStyle:"normal"},y={boxShadow:"inset 0 -2px 2px rgba(0,0,0,.1)",backgroundColor:"white",fontSize:"2.9rem",width:"4.5rem",height:"4.5rem",borderRadius:"10px",position:"relative"},g={position:"absolute",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",color:"rgb(64, 173, 224)",fontWeight:400},w={color:"rgb(112, 64, 224)",textWrap:"wrap",textAlign:"center",fontSize:"1rem",fontWeight:600,fontStyle:"normal"},b={fontWeight:400,color:"rgb(51, 51, 51)"},v={width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"1rem"},x={boxShadow:"inset 0 -2px 2px rgba(0,0,0,.1)",padding:".4rem 0",width:"100%",borderRadius:"10px",backgroundColor:"rgb(247, 247, 247)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},C=document.createElement("style");C.textContent=[{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-Regular.ttf",weight:400,style:"regular"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-Bold.ttf",weight:700,style:"bold"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-Black.ttf",weight:900,style:"black"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-Italic.ttf",weight:400,style:"italic"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-BoldItalic.ttf",weight:700,style:"boldItalic"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-ExtraBold.ttf",weight:800,style:"extraBold"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-ExtraBoldItalic.ttf",weight:800,style:"extraBoldItalic"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-Thin.ttf",weight:100,style:"thin"},{name:"MontserratAlternates",file:"../../fonts/Montserrat_Alternates/MontserratAlternates-ThinItalic.ttf",weight:100,style:"thinItalic"}].map((({name:e,file:t,weight:r,style:n})=>`\n    @font-face {\n      font-family: '${e}';\n      src: url('/fonts/${t}') format('truetype');\n      font-weight: ${r};\n      font-style: ${n};\n    }\n  `)).join("\n"),document.head.appendChild(C);const M=["отчетная дата","краткое наименование","отчетный период"];class A{constructor(e){this.year=e}async init(){this.rawJSON=await this.getRawJSON(),this.sorted=await this.JSON_sorted()}isDev=!1;async CDN_or_Local(){if(this.isDev)return window.XLSX||await new Promise((e=>{const t=document.createElement("script");t.src="https://cdn.sheetjs.com/xlsx-0.18.5/package/dist/xlsx.full.min.js",t.onload=e,document.head.appendChild(t)})),window.XLSX;{const e=await a.e(138).then(a.bind(a,138));return e.default||e}}async getRawJSON(){const e=await this.CDN_or_Local(),t=`https://raw.githubusercontent.com/Kanoe99/files/main/stat_calendar_${this.year}.xlsx`,r=await fetch(t),n=await r.arrayBuffer(),a=e.read(n,{type:"array"}),s=a.SheetNames[0],i=a.Sheets[s],o=e.utils.sheet_to_json(i,{header:1,defval:""}).map((e=>e.map((e=>void 0!==e||null!==e?e.toString():"")))),l=o[0],[d,c,h]=M.map((e=>l.findIndex((t=>function(e){return e.toLowerCase().replace(/ё/g,"е")}(t).includes(e))))),p=[c,h,d],u=o.filter(((e,t,r)=>!e[o[0].findIndex((e=>e.trim().toLowerCase().includes("примечание")))].trim().toLowerCase().includes("отмен"))).map(((t,r)=>t.map(((t,n)=>({name:`${e.utils.encode_col(n)}.${r+1}`,value:t}))).filter(((e,t)=>p.includes(t))).map(((e,t)=>{if(2===t&&/^\d+$/.test(e.value)){const t=parseInt(e.value,10),r=new Date(Date.UTC(1899,11,30)),n=864e5,a=new Date(r.getTime()+t*n),s=new Intl.DateTimeFormat("ru-RU").format(a);return{name:e.name,value:s}}return e})))),m=(e,t)=>{if(e.value.trim()){if(2===t){if(/^\d{2}\.\d{2}\.\d{4}$/.test(e.value)){const[t,r,n]=e.value.split(".").map(Number),a=new Date(n,r-1,t);return a.getFullYear()===n&&a.getMonth()===r-1&&a.getDate()===t}return!1}return!0}return!1},f=u.filter((e=>e.every(m))),y=u.filter((e=>!e.every(m))),g=[];return 0===Object.keys(y).length?g["Вы молодец"]=["Ошибок в Excel файле нет!"]:y.slice(1).forEach((e=>e.forEach(((e,t)=>{const r=e.value,n=e.name;if(r.trim()){if(2===t)if(/^\d{2}\.\d{2}\.\d{4}$/.test(r)){const[t,a,s]=e.value.split(".").map(Number),i=new Date(s,a-1,t);i.getFullYear()===s&&i.getMonth()===a-1&&i.getDate()===t||(g[`Образец даты ${n}: <dd.mm.yyyy>`]=`${n}: [${r}]`)}else g[`Образец даты ${n}: <dd.mm.yyyy>`]=`${n}: [${r}]`}else g[`Пустая ячейка ${n}`]=`${n}: [${r}]`})))),console.table(g),f.map((e=>e.map((e=>e.value))))}async JSON_sorted(){const e=this.rawJSON,t=Number(e[0][2].split(".")[2]),r=[new Array(31),new Array(t%4==0?29:28),new Array(31),new Array(30),new Array(31),new Array(30),new Array(31),new Array(31),new Array(30),new Array(31),new Array(30),new Array(31)];return e.forEach((e=>{const t=Number(e[2].split(".")[0])-1,n=Number(e[2].split(".")[1])-1;r[n][t]?r[n][t].push([e[0],e[1]]):r[n][t]=[[e[0],e[1]]]})),r}}class E{constructor(e){this.cms_block=e,this.requestedYear=new URLSearchParams(window.location.search).get("y"),this.requestedMonth=(()=>{const e=new URLSearchParams(window.location.search).get("m");return null===e||isNaN(e)?null:Number(e)-1})(),this.nowYear=(new Date).getFullYear(),this.nowMonth=(new Date).getMonth();const t={currentMonth:this.requestedMonth??this.nowMonth,displayedYear:this.requestedYear??this.nowYear,hiddenYear:null!==this.requestedYear&&this.requestedYear!==this.nowYear?this.requestedYear+1:this.nowYear-1};this.currentMonthEl=null,this.displayedYearEl=null,this.state=new Proxy(t,{set:async(e,t,r,n)=>{const a=Reflect.set(e,t,r,n);return"currentMonth"===t&&(this.parser?.sorted&&(this.data=this.parser.sorted[r]),this.currentMonthEl&&(this.currentMonthEl.textContent=this.getMonthNames(r)),this.build()),"displayedYear"===t&&(this.parser=new A(r),await this.parser.init(),this.data=this.parser.sorted[this.state.currentMonth],this.displayedYearEl&&(this.displayedYearEl.textContent=r),this.build()),a}})}async init(){return this.parser=new A(this.state.displayedYear),await this.parser.init(),this.data=this.parser.sorted[this.state.currentMonth],this.build(),this}build=async()=>{this.cms_block.innerHTML="",this.create_DOM(this.cms_block),this.assignStyles()};create_DOM(e){const t=document.createElement("div");t.classList="outerWrapper",Array.isArray(this.data)?(this.data.forEach(((e,r)=>{const n=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div");a.classList="circleDigit",a.textContent=r+1,i.classList="circleWrapper",s.classList="list",n.classList="innerWrapper",e.forEach((e=>{const t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div");t.textContent=e[0],r.textContent=e[1],t.classList="blueUpper",r.classList="blackLower",n.classList="smallListContainer",n.appendChild(t),n.appendChild(r),s.appendChild(n)})),i.appendChild(a),n.appendChild(i),n.appendChild(s),t.appendChild(n)})),this.createPicker(e),e.appendChild(t)):console.error(`this.data: ${this.data}`)}getMonthNames(e){const t=new Date(this.state.displayedYear,e),r=new Intl.DateTimeFormat("ru-RU",{month:"long"}).format(t);return r[0].toUpperCase()+r.slice(1)}createPicker(e){const t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),a=document.createElement("div"),s=document.createElement("div"),i=document.createElement("div"),o=document.createElement("div");t.classList="dateWrapper",r.classList="yearWrapper",s.classList="monthsOuterWrapper",a.classList="hiddenYear",this.hiddenYear=a,a.textContent=this.state.hiddenYear,n.classList="displayedYear",this.displayedYearEl=n,n.textContent=this.state.displayedYear,r.appendChild(n),r.appendChild(a),n.addEventListener("click",(async()=>{const e=this.state.hiddenYear,t=this.state.displayedYear;this.state.displayedYear=e,this.state.hiddenYear=t,this.hiddenYear.textContent=t})),i.classList="currentMonth",this.currentMonthEl=i,o.classList="monthsInnerWrapper";for(let e=0;e<12;e++){const t=document.createElement("div");t.textContent=this.getMonthNames(e),t.className="month",o.appendChild(t),t.addEventListener("click",(()=>{o.style.display="none",this.state.currentMonth=e}))}i.textContent=this.getMonthNames(this.state.currentMonth),i.addEventListener("click",(()=>{const e=o.style;e.display="none"===e.display?"block":"none"})),s.appendChild(i),s.appendChild(o),t.appendChild(s),e.appendChild(r),e.appendChild(t)}assignStyles=()=>{for(const e in s){const t=s[e],r=t.hover,{hover:n,...a}=t;document.querySelectorAll(`.${e}`).forEach((e=>{Object.assign(e.style,a),r&&(e.addEventListener("mouseenter",(()=>{Object.assign(e.style,r)})),e.addEventListener("mouseleave",(()=>{for(const t in r)e.style[t]="";Object.assign(e.style,a)})))}))}}}document.addEventListener("DOMContentLoaded",(async()=>{const e=document.getElementById("c447f2f0-11ee-4833-9f95-cd7c08ba671e")?.parentElement;if(e){const t=new E(e);await t.init()}}))})();